cmake_minimum_required(VERSION 3.17)
project(lslidar_cx_driver)

set(CMAKE_CXX_STANDARD 14)
set(CMAKE_BUILD_TYPE Release)

# 设置 Boost 的路径
set(BOOST_INCLUDEDIR "/usr/include")
set(BOOST_LIBRARYDIR "/usr/lib")

# 设置 libpcap 的路径
set(PCAP_LIBRARY "-lpcap")
set(PCAP_INCLUDE_DIR "/usr/include")

include_directories(
    include
    ${BOOST_INCLUDEDIR}
    ${PCAP_INCLUDE_DIR}
    /usr/include/boost/signals2
    $ENV{HOME}/dora/apis/c/node # dora的头文件路径 node_api.h
    $ENV{HOME}/dora/apis/c/operator
)

link_directories(
    ${BOOST_LIBRARYDIR}
)

add_definitions("-D${PROJECT_NAME}_VERSION=\"${${PROJECT_NAME}_VERSION}\"")

# 编译 lslidar_cx_input 库
add_library(lslidar_cx_input src/input.cc)
target_link_libraries(lslidar_cx_input
    ${PCAP_LIBRARY}
    ${Boost_LIBRARIES}
)

# 编译 lslidar_cx_driver 库
add_library(lslidar_cx_driver src/lslidar_driver.cpp)
target_link_libraries(lslidar_cx_driver
    lslidar_cx_input
    $ENV{HOME}/dora/target/release/libdora_node_api_c.a
    ${Boost_LIBRARIES}
    boost_thread
)

# 编译可执行文件 test，并链接 lslidar_cx_driver 库
add_executable(test src/main.cc)
target_link_libraries(test
    lslidar_cx_driver
    lslidar_cx_input
    $ENV{HOME}/dora/target/release/libdora_node_api_c.a
    ${Boost_LIBRARIES}
    boost_thread
)
